# **9️⃣ React Testing**  

Testing ensures that React applications work correctly by verifying individual components, API interactions, and user flows. React supports multiple testing strategies, including **unit tests**, **integration tests**, and **end-to-end (E2E) tests**.

---

## **9.1 Introduction to Testing in React**  

📌 **Why Testing?**  
- Detects bugs early.  
- Ensures app stability during updates.  
- Improves code quality and maintainability.  

📌 **Types of Testing in React:**  
1. **Unit Testing** – Tests individual functions or components.  
2. **Integration Testing** – Tests multiple components together.  
3. **End-to-End (E2E) Testing** – Simulates real user interactions.  

---

## **9.2 Unit Testing with Jest & React Testing Library**  

### **🔹 Setting Up Jest & React Testing Library (RTL)**  
✅ Jest and RTL are included in **Create React App (CRA)** by default. If not, install manually:  
```bash
npm install --save-dev jest @testing-library/react @testing-library/jest-dom
```

### **🔹 Writing a Simple Unit Test**  
✅ **Example: Testing a Button Component**  
```tsx
// Button.tsx
import React from "react";

interface ButtonProps {
  text: string;
  onClick: () => void;
}

const Button: React.FC<ButtonProps> = ({ text, onClick }) => {
  return <button onClick={onClick}>{text}</button>;
};

export default Button;
```

✅ **Unit Test for Button Component**  
```tsx
// Button.test.tsx
import { render, screen, fireEvent } from "@testing-library/react";
import Button from "./Button";

test("renders button with given text and triggers click event", () => {
  const mockClick = jest.fn(); // Mock function
  render(<Button text="Click Me" onClick={mockClick} />);

  const button = screen.getByText("Click Me");
  expect(button).toBeInTheDocument();

  fireEvent.click(button);
  expect(mockClick).toHaveBeenCalledTimes(1);
});
```

📌 **Key Takeaways:**  
- **`render()`** – Renders the component in a virtual DOM.  
- **`screen.getByText()`** – Queries for the button text.  
- **`fireEvent.click()`** – Simulates a button click.  
- **`jest.fn()`** – Creates a mock function to track calls.  

---

## **9.3 Mocking API Calls in Tests**  

📌 **Why Mock API Calls?**  
- Prevents real network requests in tests.  
- Makes tests run faster and more predictably.  

### **🔹 Mocking API Calls with Jest**  
✅ **Example: Fetching User Data**  
```tsx
// fetchUser.ts
export const fetchUser = async () => {
  const response = await fetch("https://jsonplaceholder.typicode.com/users/1");
  if (!response.ok) throw new Error("Failed to fetch user");
  return response.json();
};
```

✅ **Mocking API Call in Test**  
```tsx
// fetchUser.test.ts
import { fetchUser } from "./fetchUser";

global.fetch = jest.fn(() =>
  Promise.resolve({
    ok: true,
    json: () => Promise.resolve({ id: 1, name: "John Doe" }),
  })
) as jest.Mock;

test("fetchUser returns user data", async () => {
  const user = await fetchUser();
  expect(user).toEqual({ id: 1, name: "John Doe" });
});
```

📌 **Key Takeaways:**  
- **Mock `fetch()` globally** to prevent real API calls.  
- **Return a resolved Promise** with test data.  
- **Use `expect()`** to validate the returned data.  

---

## **9.4 End-to-End (E2E) Testing with Cypress**  

📌 **What is Cypress?**  
Cypress is an E2E testing framework that simulates real user interactions in a browser.

### **🔹 Installing Cypress**  
```bash
npm install --save-dev cypress
```

### **🔹 Running Cypress**  
```bash
npx cypress open
```
This opens the Cypress test runner.

### **🔹 Writing a Simple Cypress Test**  
✅ **Example: Testing a Login Page**  
```js
// cypress/integration/login.spec.js
describe("Login Page", () => {
  it("logs in successfully with correct credentials", () => {
    cy.visit("http://localhost:3000/login"); // Open login page
    cy.get('input[name="email"]').type("user@example.com");
    cy.get('input[name="password"]').type("password123");
    cy.get('button[type="submit"]').click();

    cy.url().should("include", "/dashboard"); // Ensure redirection
  });
});
```

📌 **Key Cypress Commands:**  
- `cy.visit()` – Opens a URL.  
- `cy.get()` – Selects an element.  
- `cy.type()` – Simulates typing.  
- `cy.click()` – Clicks an element.  
- `cy.url().should()` – Asserts URL changes.  

---

## **📌 Summary**  
✔ **Jest & React Testing Library** – Unit testing for components.  
✔ **Mocking API Calls** – Prevents real network requests in tests.  
✔ **Cypress** – Simulates real user interactions for E2E testing.  

🔥 **Next Topic: 1️⃣0️⃣ React Performance Optimization**  

Let me know if you need any improvements! 🚀