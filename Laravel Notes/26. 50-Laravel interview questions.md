### **Additional Laravel Interview Questions & Answers**  

#### **1. What are Laravel Macros?**  
✅ **Answer:** Macros allow defining reusable methods dynamically in Laravel classes using the `Macroable` trait.  
```php
use Illuminate\Support\Str;

Str::macro('removeSpaces', function ($value) {
    return str_replace(' ', '', $value);
});

echo Str::removeSpaces('Hello World'); // Outputs: HelloWorld
```

---

#### **2. What is Laravel’s Lazy Loading vs Eager Loading?**  
✅ **Answer:**  
- **Lazy Loading:** Loads related data **on-demand** (causes N+1 problem).  
- **Eager Loading:** Loads all related data **in advance** using `with()`.  
```php
$users = User::with('posts')->get(); // Eager loading
```

---

#### **3. How do you implement soft deletes in Laravel?**  
✅ **Answer:** Add `SoftDeletes` trait in the model.  
```php
use Illuminate\Database\Eloquent\SoftDeletes;

class Post extends Model {
    use SoftDeletes;
}
```
Deleted records remain in the database but are ignored by default queries.

---

#### **4. How to validate incoming requests in Laravel?**  
✅ **Answer:** Use **Form Requests**:  
```sh
php artisan make:request StoreUserRequest
```
Define validation in `rules()` method:  
```php
public function rules() {
    return [
        'email' => 'required|email|unique:users',
        'password' => 'required|min:8',
    ];
}
```

---

#### **5. How do you create a custom validation rule?**  
✅ **Answer:**  
```sh
php artisan make:rule CheckAge
```
Modify the `passes` method:  
```php
public function passes($attribute, $value) {
    return $value >= 18; // Ensure user is 18+
}
```
Use it in a request:  
```php
$request->validate(['age' => new CheckAge]);
```

---

#### **6. What is Laravel Horizon?**  
✅ **Answer:** Horizon provides a beautiful dashboard for managing Laravel queues powered by Redis. Install it using:  
```sh
composer require laravel/horizon
php artisan horizon:install
php artisan horizon
```

---

#### **7. How do you create a custom Artisan command?**  
✅ **Answer:**  
```sh
php artisan make:command SendNewsletter
```
Modify `handle()` method:  
```php
public function handle() {
    Mail::send(new NewsletterMail());
    $this->info('Newsletter sent!');
}
```

---

#### **8. How to prevent mass assignment in Laravel?**  
✅ **Answer:** Use **$fillable** or **$guarded** in models.  
```php
protected $fillable = ['title', 'body']; // Allows mass assignment
```

---

#### **9. What is Inertia.js in Laravel?**  
✅ **Answer:** Inertia.js is used for building **SPA-like applications** without using APIs.  
```sh
composer require inertiajs/inertia-laravel
```

---

#### **10. How to configure CORS in Laravel?**  
✅ **Answer:** Modify `cors.php` in `config`:  
```php
'paths' => ['api/*'],
'allowed_methods' => ['*'],
'allowed_origins' => ['*'],
```

---

#### **11. What are Laravel’s API Resources?**  
✅ **Answer:**  
```sh
php artisan make:resource UserResource
```
Modify `toArray()` method:  
```php
public function toArray($request) {
    return [
        'id' => $this->id,
        'email' => $this->email,
    ];
}
```

---

#### **12. How do you use Laravel Livewire?**  
✅ **Answer:**  
```sh
composer require livewire/livewire
```
Use the Livewire component in a Blade file:  
```php
<livewire:counter />
```

---

#### **13. What is Laravel’s Observer Pattern?**  
✅ **Answer:** Use `Observer` to listen to model events.  
```sh
php artisan make:observer UserObserver --model=User
```
Register in `AppServiceProvider`:  
```php
User::observe(UserObserver::class);
```


---

#### **14. What is the difference between `first()` and `firstOrFail()`?**  
✅ **Answer:**  
- `first()`: Returns the first record or `null`.  
- `firstOrFail()`: Throws a `ModelNotFoundException` if no record exists.  


---

#### **15. How do you use subqueries in Laravel?**  
✅ **Answer:**  
```php
$latestOrders = Order::select('user_id', DB::raw('(SELECT MAX(id) FROM orders WHERE user_id = users.id) as latest_order_id'));
```

---

#### **16. What is the difference between `pluck()` and `select()`?**  
✅ **Answer:**  
- `pluck('column')`: Returns a simple array of values.  
- `select('column')`: Returns a collection with all attributes.  

#### **17. How do you use UUID instead of auto-increment ID?**  
✅ **Answer:**  
```php
use Illuminate\Support\Str;

protected static function boot() {
    parent::boot();
    static::creating(function ($model) {
        $model->id = Str::uuid();
    });
}
```

---

#### **18. How do you implement a repository pattern in Laravel?**  
✅ **Answer:**  
- Create an interface:  
```php
interface UserRepositoryInterface {
    public function getAllUsers();
}
```
- Create a repository:  
```php
class UserRepository implements UserRepositoryInterface {
    public function getAllUsers() {
        return User::all();
    }
}
```
- Bind it in `AppServiceProvider`:  
```php
$this->app->bind(UserRepositoryInterface::class, UserRepository::class);
```

---

#### **19. What is Laravel Scout?**  
✅ **Answer:** It provides full-text search using Algolia, Meilisearch, or database indexing.  
```sh
composer require laravel/scout
```

---

#### **20. How do you handle CSRF in Laravel?**  
✅ **Answer:** CSRF token is included in Blade forms:  
```php
@csrf
```
For APIs, exclude routes in `VerifyCsrfToken.php`.

---

#### **21. How do you create and use Laravel Facades?**  
✅ **Answer:** Facades provide static-like access to classes in the service container.  
```php
class MyService {
    public function sayHello() {
        return "Hello!";
    }
}

// Create a facade
class MyFacade extends Facade {
    protected static function getFacadeAccessor() {
        return 'myservice';
    }
}
```
Register in `AppServiceProvider`:  
```php
$this->app->singleton('myservice', function () {
    return new MyService();
});
```
Use it:  
```php
echo MyFacade::sayHello();
```

---

#### **22. How do you use multiple database connections in Laravel?**  
✅ **Answer:** Configure databases in `config/database.php`:  
```php
'mysql2' => [
    'driver' => 'mysql',
    'host' => env('DB_HOST_SECONDARY'),
    'database' => env('DB_DATABASE_SECONDARY'),
    ...
],
```
Use connection:  
```php
DB::connection('mysql2')->table('users')->get();
```

---

#### **23. How do you use Traits in Laravel?**  
✅ **Answer:** Traits allow code reuse across multiple models/controllers.  
```php
trait LogsActivity {
    public function log($message) {
        Log::info($message);
    }
}
```
Use in a model:  
```php
class User extends Model {
    use LogsActivity;
}
```

---

#### **24. How do you implement dependency injection in Laravel?**  
✅ **Answer:** Inject dependencies via the constructor.  
```php
class UserService {
    protected $userRepository;
    public function __construct(UserRepository $userRepository) {
        $this->userRepository = $userRepository;
    }
}
```
Laravel automatically resolves dependencies when used in controllers.

---

#### **25. What is Laravel Passport, and how is it used?**  
✅ **Answer:** Passport provides OAuth2 authentication for APIs.  
```sh
composer require laravel/passport
php artisan passport:install
```
Use middleware:  
```php
Route::middleware('auth:api')->get('/user', function (Request $request) {
    return $request->user();
});
```

---

#### **26. How do you handle file uploads in Laravel?**  
✅ **Answer:**  
```php
$request->file('avatar')->store('avatars');
```
Store in public folder:  
```php
$request->file('avatar')->storePublicly('avatars', 'public');
```

---

#### **27. How do you encrypt and decrypt data in Laravel?**  
✅ **Answer:**  
```php
$encrypted = encrypt('SecretData');
$decrypted = decrypt($encrypted);
```

---

#### **28. What is Laravel’s “when()” method used for?**  
✅ **Answer:**  
```php
$query = User::when(request('role'), function ($q, $role) {
    return $q->where('role', $role);
})->get();
```
Conditionally applies a query based on a parameter.

---

#### **29. How do you rollback a migration in Laravel?**  
✅ **Answer:**  
```sh
php artisan migrate:rollback
```
Rollback a specific batch:  
```sh
php artisan migrate:rollback --step=2
```

---

#### **30. What is the difference between `nullable()` and `default()` in Laravel migrations?**  
✅ **Answer:**  
- `nullable()`: Allows `NULL` values.  
- `default()`: Sets a default value.  
```php
$table->string('name')->nullable();
$table->string('role')->default('user');
```

---

#### **31. How to schedule commands in Laravel?**  
✅ **Answer:**  
Define in `app/Console/Kernel.php`:  
```php
$schedule->command('emails:send')->daily();
```
Run scheduler:  
```sh
php artisan schedule:run
```

---

#### **32. How do you cache database queries in Laravel?**  
✅ **Answer:**  
```php
$users = Cache::remember('users', 60, function () {
    return User::all();
});
```

---

#### **33. What is Laravel Sanctum?**  
✅ **Answer:**  
Sanctum provides API authentication using tokens.  
```sh
composer require laravel/sanctum
php artisan vendor:publish --provider="Laravel\Sanctum\SanctumServiceProvider"
php artisan migrate
```
Use middleware:  
```php
Route::middleware('auth:sanctum')->get('/user', function (Request $request) {
    return $request->user();
});
```

---

#### **34. What is Laravel's `tap()` function?**  
✅ **Answer:**  
```php
$user = tap(User::find(1), function ($user) {
    $user->update(['name' => 'New Name']);
});
```
Executes a function and returns the model.

---

#### **35. What is the difference between `updateOrInsert()` and `firstOrCreate()`?**  
✅ **Answer:**  
- `updateOrInsert()`: Updates or inserts without fetching.  
- `firstOrCreate()`: Retrieves the record first, then inserts if not found.

---

#### **36. How do you use Laravel's `DB::transaction()`?**  
✅ **Answer:**  
```php
DB::transaction(function () {
    User::create([...]);
    Order::create([...]);
});
```
Ensures atomicity.

---

#### **37. How do you implement roles and permissions in Laravel?**  
✅ **Answer:** Use `spatie/laravel-permission`:  
```sh
composer require spatie/laravel-permission
```
Assign roles:  
```php
$user->assignRole('admin');
```
Check roles:  
```php
if ($user->hasRole('admin')) {
    // ...
}
```

---

#### **38. What is Laravel's model binding?**  
✅ **Answer:**  
```php
Route::get('/users/{user}', function (User $user) {
    return $user;
});
```
Automatically resolves the `User` model.

---

#### **39. How do you use `hasOneThrough` relationship in Laravel?**  
✅ **Answer:**  
```php
class Country extends Model {
    public function owner() {
        return $this->hasOneThrough(Owner::class, Car::class);
    }
}
```

---

#### **40. How do you optimize database queries in Laravel?**  
✅ **Answer:**  
- **Use `select()` to fetch only required columns.**  
- **Use `chunk()` for large datasets.**  
- **Use `EXPLAIN` to analyze queries.**  

---

#### **41. How do you use Laravel's route model binding?**  
✅ **Answer:**  
```php
Route::get('/users/{user}', function (User $user) {
    return $user;
});
```

---

#### **42. What is the difference between `map()` and `each()` in collections?**  
✅ **Answer:**  
- `map()`: Returns a **new collection**.  
- `each()`: Modifies the **existing collection**.  

---

#### **43. How do you define a global scope in Laravel?**  
✅ **Answer:**  
```php
class ActiveUserScope implements Scope {
    public function apply(Builder $builder, Model $model) {
        $builder->where('status', 'active');
    }
}
```
Use in a model:  
```php
protected static function booted() {
    static::addGlobalScope(new ActiveUserScope);
}
```

---

#### **44. How do you use polymorphic relationships in Laravel?**  
✅ **Answer:**  
```php
class Comment extends Model {
    public function commentable() {
        return $this->morphTo();
    }
}
```

---

#### **45. How to use `whereHas()` in Laravel?**  
✅ **Answer:**  
```php
User::whereHas('posts', function ($query) {
    $query->where('status', 'published');
})->get();
```

---

#### **46. What is the difference between soft deletes and permanent deletes in Laravel?**  
✅ **Answer:**  
- **Soft Deletes:** The record is **not actually deleted**; instead, a `deleted_at` timestamp is set.  
- **Permanent Deletes:** The record is **completely removed** from the database.  

**Soft delete example:**  
```php
use Illuminate\Database\Eloquent\SoftDeletes;

class User extends Model {
    use SoftDeletes;
}
```
Retrieve only non-deleted records:  
```php
User::all(); // Excludes soft deleted records
```
Retrieve all including deleted:  
```php
User::withTrashed()->get();
```
Permanently delete:  
```php
$user->forceDelete();
```

---

#### **47. How do you implement API pagination in Laravel?**  
✅ **Answer:** Laravel provides built-in pagination using `paginate()`.  
```php
return User::paginate(10);
```
For API responses:  
```php
return response()->json(User::paginate(10));
```

---

#### **48. How do you configure a custom validation rule in Laravel?**  
✅ **Answer:**  
Create a custom validation rule using Artisan:  
```sh
php artisan make:rule Uppercase
```
Modify the generated rule in `app/Rules/Uppercase.php`:  
```php
public function passes($attribute, $value) {
    return strtoupper($value) === $value;
}
public function message() {
    return 'The :attribute must be in uppercase.';
}
```
Use in a request:  
```php
$request->validate([
    'name' => ['required', new Uppercase]
]);
```

---

#### **49. How do you handle JSON responses in Laravel?**  
✅ **Answer:**  
Use Laravel’s built-in response helper:  
```php
return response()->json([
    'success' => true,
    'message' => 'Data fetched successfully',
    'data' => $users
]);
```
Set custom HTTP status codes:  
```php
return response()->json(['error' => 'Unauthorized'], 401);
```

---

#### **50. What is Laravel's `broadcastOn()` method in events?**  
✅ **Answer:**  
`broadcastOn()` defines which channel an event will be broadcast to.  
```php
class MessageSent implements ShouldBroadcast {
    public function broadcastOn() {
        return new Channel('chat-room');
    }
}
```
This will push the event to `chat-room` WebSocket listeners.

---
