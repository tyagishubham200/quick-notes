Here is **Section 12: Security in JavaScript** with explanations and examples.  

---

# **12. Security in JavaScript**  

Security is a crucial aspect of JavaScript development. Web applications are vulnerable to several security threats, including **Cross-Site Scripting (XSS)**, **Cross-Site Request Forgery (CSRF)**, and **Cross-Origin Resource Sharing (CORS) issues**.  

---

## **12.1 XSS (Cross-Site Scripting)**  

### **What is XSS?**  
XSS occurs when an attacker injects **malicious scripts** into web pages viewed by other users. These scripts can **steal cookies, session tokens, or perform unauthorized actions** on behalf of users.  

### **Example of XSS Vulnerability**  
‚ùå **Vulnerable Code (User Input Directly Injected into HTML)**  
```javascript
const userInput = '<script>alert("Hacked!");</script>';
document.getElementById('output').innerHTML = userInput;
```
‚úÖ **Fix: Escape User Input Using `textContent`**  
```javascript
document.getElementById('output').textContent = userInput;
```
‚úÖ **Fix: Use a Library Like DOMPurify (For Sanitization)**  
```javascript
const sanitizedInput = DOMPurify.sanitize(userInput);
document.getElementById('output').innerHTML = sanitizedInput;
```
‚úÖ **Other Preventive Measures**  
- **Use Content Security Policy (CSP)** to restrict script execution.  
- **Sanitize inputs** on both frontend & backend.  
- **Avoid `innerHTML`** and prefer `textContent` for inserting user data.  

---

## **12.2 CSRF (Cross-Site Request Forgery)**  

### **What is CSRF?**  
CSRF tricks authenticated users into **unintentionally submitting requests** to perform actions they didn't intend, like transferring money or changing a password.

### **Example of a CSRF Attack**  
A malicious site can trick users into making an unwanted request:  
```html
<img src="https://bank.com/transfer?amount=1000&to=attacker" />
```
If the user is logged into `bank.com`, this request **executes automatically** without their consent.  

‚úÖ **Fix: Use CSRF Tokens**  
Servers should require a **unique, random token** with each request:  
```html
<input type="hidden" name="csrf_token" value="random123456">
```
The server validates this token before processing requests.

‚úÖ **Other Preventive Measures**  
- **Use SameSite Cookies** (`SameSite=Strict` to prevent cross-site requests).  
- **Verify HTTP Referer Headers** to detect unauthorized requests.  
- **Implement CORS properly** to block unwanted cross-origin requests.  

---

## **12.3 CORS (Cross-Origin Resource Sharing)**  

### **What is CORS?**  
CORS is a security feature that **blocks web pages from making unauthorized requests** to another domain.  

### **Example of a Blocked CORS Request**  
A frontend app (`https://frontend.com`) tries to call an API (`https://api.example.com`):  
```javascript
fetch('https://api.example.com/data')
  .then(response => response.json())
  .catch(error => console.error('CORS Error:', error));
```
‚ùå If the API does not allow `frontend.com`, the request **fails**.

‚úÖ **Fix: Set CORS Headers on the Server**  
```javascript
app.use((req, res, next) => {
    res.setHeader('Access-Control-Allow-Origin', 'https://frontend.com');
    res.setHeader('Access-Control-Allow-Methods', 'GET, POST');
    res.setHeader('Access-Control-Allow-Headers', 'Content-Type');
    next();
});
```
‚úÖ **Other Preventive Measures**  
- **Use `Access-Control-Allow-Origin` carefully** (avoid `*` in sensitive APIs).  
- **Restrict allowed methods** (`GET, POST`, etc.).  
- **Implement authentication** to secure sensitive API routes.  

---

### **Summary Table**  

| Security Threat | Description | Fix |
|----------------|-------------|-----|
| **XSS** | Injecting malicious scripts into web pages | Use `textContent`, sanitize input, enable CSP |
| **CSRF** | Forcing users to perform unintended actions | Use CSRF tokens, SameSite cookies |
| **CORS Issues** | Blocking unauthorized cross-origin requests | Configure CORS headers properly |

---

This concludes **Section 12: Security in JavaScript**. ‚úÖ  

Would you like me to continue with **Section 13: JavaScript Memory Management & Garbage Collection**? üöÄ